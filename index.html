<!DOCTYPE html>
<html lang="sq">
<head>
<meta charset="UTF-8">
<title>Spider-Man: City Missions</title>
<style>
body {
  margin: 0;
  background: #050505;
  overflow: hidden;
  font-family: Arial, sans-serif;
}

#ui {
  position: absolute;
  top: 10px;
  left: 10px;
  color: white;
  font-size: 18px;
  z-index: 10;
  text-shadow: 2px 2px 4px black;
}

canvas {
  display: block;
  margin: auto;
  background: linear-gradient(#1e3c72, #2a5298);
}
</style>
</head>
<body>

<div id="ui">
  <div id="mission"></div>
  <div id="hp"></div>
  <div id="score"></div>
</div>

<canvas id="game" width="900" height="500"></canvas>

<script>
// --------- PLAYER ---------
const player = { x:100, y:360, w:35, h:60, speed:5, hp:100, score:0 };

// --------- ENEMIES ---------
const enemies = [
  { x:650, y:360, w:35, h:60, alive:true },
  { x:750, y:360, w:35, h:60, alive:true }
];

// --------- MISSIONS ---------
const missions = [
  { text:"Shko te pika üü°", completed:false, check:p=>p.x>420 },
  { text:"Mund armikun (F)", completed:false, check:(p,e)=>e.every(x=>!x.alive) },
  { text:"Kthehu n√´ baz√´", completed:false, check:p=>p.x<120 }
];
let currentMission = 0;

// --------- CANVAS ---------
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const keys = {};
addEventListener("keydown", e=>keys[e.key]=true);
addEventListener("keyup", e=>keys[e.key]=false);

// --------- FUNCTIONS ---------
function updatePlayer() {
  if(keys["ArrowRight"]) player.x+=player.speed;
  if(keys["ArrowLeft"]) player.x-=player.speed;
}
function drawPlayer() {
  ctx.fillStyle="red";
  ctx.fillRect(player.x, player.y, player.w, player.h);
  ctx.fillStyle="white";
  ctx.fillRect(player.x+6,player.y+12,8,8);
  ctx.fillRect(player.x+21,player.y+12,8,8);
}

function updateEnemies() {
  enemies.forEach(e=>{
    if(e.alive && keys["f"] && collide(player,e)) e.alive=false;
  });
}

function drawEnemies() {
  enemies.forEach(e=>{
    if(!e.alive) return;
    ctx.fillStyle="#000"; ctx.fillRect(e.x,e.y,e.w,e.h);
    ctx.fillStyle="red";
    ctx.fillRect(e.x+10,e.y+15,5,5);
    ctx.fillRect(e.x+20,e.y+15,5,5);
  });
}

function updateMissions() {
  if(missions[currentMission] && missions[currentMission].check(player,enemies)) {
    missions[currentMission].completed=true;
    currentMission++;
  }
}

function updateUI() {
  document.getElementById("mission").innerText=missions.find(m=>!m.completed)?.text || "üéâ Misionet u kryen!";
  document.getElementById("hp").innerText="‚ù§Ô∏è "+player.hp;
  document.getElementById("score").innerText="‚≠ê "+player.score;
}

function drawCity() {
  let g = ctx.createLinearGradient(0,0,0,500);
  g.addColorStop(0,"#1e3c72"); g.addColorStop(1,"#2a5298");
  ctx.fillStyle=g; ctx.fillRect(0,0,900,500);
  ctx.fillStyle="#111";
  for(let i=0;i<10;i++) ctx.fillRect(i*100,220+Math.random()*30,80,300);
  ctx.fillStyle="#222"; ctx.fillRect(0,420,900,80);
}

function collide(a,b){
  return a.x < b.x+b.w && a.x+a.w > b.x && a.y < b.y+b.h && a.y+a.h > b.y;
}

// --------- GAME LOOP ---------
function update(){
  updatePlayer();
  updateEnemies();
  updateMissions();
  updateUI();
}
function draw(){
  ctx.clearRect(0,0,900,500);
  drawCity();
  drawPlayer();
  drawEnemies();
  ctx.fillStyle="yellow"; ctx.beginPath();
  ctx.arc(450,420,10,0,Math.PI*2); ctx.fill();
}

function loop(){
  update(); draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
