<!DOCTYPE html>
<html lang="sq">
<head>
<meta charset="UTF-8">
<title>Spider-Man: City Missions</title>

<style>
body {
  margin: 0;
  background: #050505;
  overflow: hidden;
  font-family: Arial, sans-serif;
}

#ui {
  position: absolute;
  top: 10px;
  left: 10px;
  color: white;
  font-size: 18px;
  z-index: 10;
  text-shadow: 2px 2px 4px black;
}

canvas {
  display: block;
  margin: auto;
}
</style>
</head>
<body>

<div id="ui">
  <div id="mission"></div>
  <div id="hp"></div>
</div>

<canvas id="game" width="900" height="500"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// PLAYER
const player = {
  x: 100,
  y: 360,
  w: 35,
  h: 60,
  speed: 5,
  hp: 100
};

// ENEMY
let enemy = {
  x: 650,
  y: 360,
  w: 35,
  h: 60,
  alive: true
};

// MISSIONS
const missions = [
  { text: "Mision 1: Shko te pika üü°", check: () => player.x > 420 },
  { text: "Mision 2: Mund armikun (F)", check: () => !enemy.alive },
  { text: "Mision 3: Kthehu n√´ baz√´", check: () => player.x < 120 }
];
let currentMission = 0;

// CONTROLS
const keys = {};
addEventListener("keydown", e => keys[e.key] = true);
addEventListener("keyup", e => keys[e.key] = false);

// UPDATE
function update() {
  if (keys["ArrowRight"]) player.x += player.speed;
  if (keys["ArrowLeft"]) player.x -= player.speed;

  if (keys["f"] && enemy.alive && collide(player, enemy)) {
    enemy.alive = false;
  }

  if (missions[currentMission] && missions[currentMission].check()) {
    currentMission++;
  }

  document.getElementById("mission").innerText =
    missions[currentMission]?.text || "üéâ Misionet u kryen!";
  document.getElementById("hp").innerText = "‚ù§Ô∏è " + player.hp;
}

// DRAW CITY
function drawCity() {
  let g = ctx.createLinearGradient(0,0,0,500);
  g.addColorStop(0,"#1e3c72");
  g.addColorStop(1,"#2a5298");
  ctx.fillStyle = g;
  ctx.fillRect(0,0,900,500);

  ctx.fillStyle = "#111";
  for (let i = 0; i < 10; i++) {
    ctx.fillRect(i*100, 220 + Math.random()*30, 80, 300);
  }

  ctx.fillStyle = "#222";
  ctx.fillRect(0, 420, 900, 80);
}

// DRAW SPIDERMAN
function drawSpiderman(p) {
  ctx.fillStyle = "red";
  ctx.fillRect(p.x, p.y, p.w, p.h);

  ctx.fillStyle = "white";
  ctx.fillRect(p.x + 6, p.y + 12, 8, 8);
  ctx.fillRect(p.x + 21, p.y + 12, 8, 8);
}

// DRAW ENEMY
function drawEnemy(e) {
  ctx.fillStyle = "#000";
  ctx.fillRect(e.x, e.y, e.w, e.h);

  ctx.fillStyle = "red";
  ctx.fillRect(e.x + 10, e.y + 15, 5, 5);
  ctx.fillRect(e.x + 20, e.y + 15, 5, 5);
}

// DRAW
function draw() {
  ctx.clearRect(0,0,900,500);
  drawCity();
  drawSpiderman(player);
  if (enemy.alive) drawEnemy(enemy);

  ctx.fillStyle = "yellow";
  ctx.beginPath();
  ctx.arc(450, 420, 10, 0, Math.PI*2);
  ctx.fill();
}

// COLLISION
function collide(a,b) {
  return a.x < b.x+b.w &&
         a.x+a.w > b.x &&
         a.y < b.y+b.h &&
         a.y+a.h > b.y;
}

// LOOP
function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
